# 条件执行示例
# 运行: ./workflow-engine run examples/07-conditional.yaml

id: conditional-workflow
name: Conditional Workflow
description: 使用条件分支的工作流示例

steps:
  # 步骤 1: 发送请求
  - id: check_api
    name: Check API Status
    type: http
    config:
      method: GET
      url: "https://httpbin.org/status/200"
    timeout: 30s

  # 步骤 2: 根据响应状态执行不同分支
  - id: handle_response
    name: Handle Response
    type: condition
    condition:
      expression: "${response.status_code} == 200"
      then:
        - id: success_handler
          name: Success Handler
          type: script
          config:
            script: |
              console.log('API is healthy!');
              ctx.SetVariable('api_status', 'healthy');
      else:
        - id: error_handler
          name: Error Handler
          type: script
          config:
            script: |
              console.log('API is down!');
              ctx.SetVariable('api_status', 'unhealthy');

  # 步骤 3: 记录结果
  - id: log_result
    name: Log Result
    type: script
    config:
      script: |
        const status = ctx.GetVariable('api_status');
        console.log('Final API status: ' + status);
