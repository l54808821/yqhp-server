# 性能测试 - 压力测试
# 运行: ./workflow-engine run examples/14-stress-test.yaml

id: stress-test
name: Stress Test
description: 持续增加负载直到系统极限的压力测试示例

options:
  mode: ramping-vus
  stages:
    # 逐步增加负载
    - duration: 1m
      target: 50
      name: "Stage 1 - 50 VUs"
    - duration: 1m
      target: 100
      name: "Stage 2 - 100 VUs"
    - duration: 1m
      target: 200
      name: "Stage 3 - 200 VUs"
    - duration: 1m
      target: 300
      name: "Stage 4 - 300 VUs"
    - duration: 1m
      target: 400
      name: "Stage 5 - 400 VUs"
    # 冷却
    - duration: 30s
      target: 0
      name: "Cool down"
  # 压力测试通常不设置严格阈值，主要观察系统行为
  thresholds:
    - metric: http_req_failed
      condition: "rate < 0.5" # 允许较高错误率

steps:
  - id: api_request
    name: API Request
    type: http
    config:
      method: GET
      url: "https://httpbin.org/get"
    timeout: 60s
