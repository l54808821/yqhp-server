# 性能测试 - 浸泡测试 (长时间稳定性测试)
# 运行: ./workflow-engine run examples/15-soak-test.yaml
# 注意: 此测试运行时间较长，用于检测内存泄漏等问题

id: soak-test
name: Soak Test
description: 长时间稳定负载测试，用于检测内存泄漏和性能退化

options:
  mode: ramping-vus
  stages:
    # 预热
    - duration: 2m
      target: 50
      name: "Warm up"
    # 长时间稳定负载
    - duration: 30m
      target: 50
      name: "Soak period"
    # 冷却
    - duration: 2m
      target: 0
      name: "Cool down"
  thresholds:
    - metric: http_req_duration
      condition: "p(95) < 500"
    - metric: http_req_failed
      condition: "rate < 0.01"

steps:
  - id: api_request
    name: API Request
    type: http
    config:
      method: GET
      url: "https://httpbin.org/get"
    timeout: 30s
